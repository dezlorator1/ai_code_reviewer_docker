# ü§ñ AI Code Reviewer

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥-—Ä–µ–≤—å—é–µ—Ä –Ω–∞ –±–∞–∑–µ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ Merge Request.

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç git diff –º–µ–∂–¥—É –≤–µ—Ç–∫–∞–º–∏, –≤—ã—è–≤–ª—è–µ—Ç –±–∞–≥–∏, –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

---

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç MR** ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ü–µ–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–µ–≤—å—é –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞** ‚Äî –∞–Ω–∞–ª–∏–∑ –±–∞–≥–æ–≤, NPE, –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è **–§–æ–∫—É—Å –Ω–∞ Query Language** ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ breaking changes –≤ —è–∑—ã–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- üìä **–ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –¥–ª—è –¢–∏–º–ª–∏–¥–∞** ‚Äî –≤–µ—Ä–¥–∏–∫—Ç, –±–∞–≥–∏, breaking changes, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–≤–æ–¥–∫–∞
- üîó **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏-–ø—Ä–æ–µ–∫—Ç–∞** ‚Äî –∞–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- üê≥ **Docker** ‚Äî –∑–∞–ø—É—Å–∫ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
ai-code-reviewer/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ dockerfile
‚îú‚îÄ‚îÄ config.yml
‚îú‚îÄ‚îÄ entrypoint.sh
‚îú‚îÄ‚îÄ main.sh
‚îú‚îÄ‚îÄ *.py                    # Python —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ *.sh                    # Bash —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ inputs/                 # üëà Diff —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ rsm-3078.diff
‚îú‚îÄ‚îÄ review_results/         # üëà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ review_logs/            # üëà –õ–æ–≥–∏ (—Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ diff —Ñ–∞–π–ª–∞

**–°–æ–∑–¥–∞–Ω–∏–µ diff:**
```bash
# –ü–æ–ª—É—á–∏—Ç–µ diff –º–µ–∂–¥—É –≤–∞—à–µ–π —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–æ–π –∏ dev
git diff $(git merge-base dev HEAD) HEAD > example.diff
```

**–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ dev:**
```bash
git checkout dev
```

**–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ diff –≤ –ø–∞–ø–∫—É inputs
cp example.diff /path/to/ai-code-reviewer/inputs/
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### docker-compose.yml

–£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å–æ –≤—Å–µ–º–∏ –≤–∞—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏:

```yaml
services:
  code-review:
    build: .
    volumes:
      # –ü–∞–ø–∫–∞ —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
      - C:\Work\Projects:/projects           # Windows
      # - /home/user/projects:/projects      # Linux/Mac
      
      # –ü–∞–ø–∫–∞ —Å diff —Ñ–∞–π–ª–∞–º–∏
      - ./inputs:/inputs
      
      # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
      - ./review_results:/app/output
      
      # –õ–æ–≥–∏
      - ./review_logs:/app/logs

    environment:
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π LLM
      - LLM_API_URL=http://host.docker.internal:1234/v1/chat/completions
      - LLM_MODEL=gpt-oss-20b
      - LLM_TEMPERATURE=0.2
      - LLM_MAX_TOKENS=16000
```

**–í–∞–∂–Ω–æ:** –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–π –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ (`/projects` –≤–Ω—É—Ç—Ä–∏ Docker).

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
docker compose run --rm code-review --diffs /inputs/rsm-3078.diff --names sm-rsm --output 3078.md
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `--diffs` ‚Äî —Å–ø–∏—Å–æ–∫ diff —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `--names` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `--output` ‚Äî –∏–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, default: summary.md)

### –ü—Ä–∏–º–µ—Ä—ã

**–û–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç:**
```bash
docker compose run --rm code-review \
  --diffs /inputs/backend-3078.diff \
  --names backend \
  --output mr-3078.md
```

**–ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤:**
```bash
docker compose run --rm code-review \
  --diffs /inputs/api.diff,/inputs/web.diff \
  --names elastic-pql-plugin,sm-tools \
  --output feature-percentile.md
```

**–î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∏–º—è (summary.md):**
```bash
docker compose run --rm code-review \
  --diffs /inputs/rsm-3078.diff \
  --names sm-rsm
```

---

## üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ `review_results/` –ø–æ—è–≤—è—Ç—Å—è:

```
review_results/
‚îú‚îÄ‚îÄ 3078.md               # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω --output)
‚îî‚îÄ‚îÄ summary.md            # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç (–µ—Å–ª–∏ --output –Ω–µ —É–∫–∞–∑–∞–Ω)
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞

```markdown
# üõ°Ô∏è –û—Ç—á–µ—Ç –ø–æ Code Review

## üö¶ –í–ï–†–î–ò–ö–¢
‚úÖ –í–´–ì–õ–Ø–î–ò–¢ –ë–ï–ó–û–ü–ê–°–ù–û / ‚ö†Ô∏è –ï–°–¢–¨ –ó–ê–ú–ï–ß–ê–ù–ò–Ø / üõë –ë–õ–û–ö–ò–†–£–Æ–©–ò–ï –ü–†–û–ë–õ–ï–ú–´

## üéØ –°–£–¢–¨ –ò–ó–ú–ï–ù–ï–ù–ò–ô
–¶–µ–ª—å: [–ß—Ç–æ –∏ –∑–∞—á–µ–º]
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: [–ö–∞–∫]

## üí• BREAKING CHANGES
[–ò–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–º–∞—é—â–∏–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å]

## üêõ –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´
### üî¥ CRITICAL
### üü° HIGH
### üü¢ MEDIUM
### ‚ö™ LOW

## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –°–í–û–î–ö–ê
[–ú–∞—Å—à—Ç–∞–±, –º–æ–¥—É–ª–∏, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∏]
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```
[1/6] –û—á–∏—Å—Ç–∫–∞ —Ä–∞–±–æ—á–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
[2/6] –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ diff —Ñ–∞–π–ª–æ–≤ (–º—É–ª—å—Ç–∏-–ø—Ä–æ–µ–∫—Ç)
[3/6] –ê–Ω–∞–ª–∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ MR
[4/6] –†–∞–∑–±–∏–µ–Ω–∏–µ diff –Ω–∞ —á–∞–Ω–∫–∏ (–ø–æ —Ñ–∞–π–ª–∞–º)
[5/6] –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–µ–≤—å—é –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
[6/6] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞
```

**–ö–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

```
extract_mr_context.py
    ‚Üì –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
    - –¶–µ–ª—å MR
    - Breaking changes
    - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
    
review_chunk.py (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞)
    ‚Üì –î–µ—Ç–∞–ª—å–Ω—ã–µ –±–∞–≥–∏
    - CRITICAL / HIGH / MEDIUM / LOW
    - Query Language –≤–ª–∏—è–Ω–∏–µ
    
summarize_reviews.py
    ‚Üì –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
    - –í–µ—Ä–¥–∏–∫—Ç
    - –°–≤–æ–¥–∫–∞ –±–∞–≥–æ–≤
    - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–≤–æ–¥–∫–∞
```

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Project directory not found"

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ –ø–∞–ø–æ–∫.

**–†–µ—à–µ–Ω–∏–µ:**
```yaml
volumes:
  # –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
  - C:\Work\Projects:/projects  # Windows
```

–ó–∞—Ç–µ–º –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `--names` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º—è –ø–∞–ø–∫–∏ –∫–∞–∫ –æ–Ω–æ –µ—Å—Ç—å:
```bash
--names sm-rsm  # –î–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –ø–∞–ø–∫–∞ C:\Work\Projects\sm-rsm
```

### –û—à–∏–±–∫–∞: "Diff file not found"

**–ü—Ä–æ–±–ª–µ–º–∞:** Diff —Ñ–∞–π–ª –Ω–µ –≤ –ø–∞–ø–∫–µ `inputs/`.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `ls inputs/`
2. –í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: `--diffs /inputs/—Ç–æ—á–Ω–æ–µ-–∏–º—è.diff`

### –°–∫—Ä–∏–ø—Ç—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:
```bash
docker compose build --no-cache
```

---

## üìñ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.yml

```yaml
paths:
  SUMMARY_FILE: summary.md      # –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∏–º—è –æ—Ç—á–µ—Ç–∞
  SUMMARY_PATH: /app/output/    # –ü—É—Ç—å –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
  LOG_FILE: /app/logs/run_reviews.log
  CHUNKS_DIR: /app/temp_chunks  # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  OUT_DIR: /app/temp_results    # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  DIFF_DIR: /app/temp_diff      # –í—Ä–µ–º–µ–Ω–Ω—ã–µ diff

llm:
  api_url: "http://localhost:1234/v1/chat/completions"
  model: "gpt-oss-20b"
  max_tokens: 16000
  temperature: 0.2
  timeout: 600
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ LLM –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏–∑ `docker-compose.yml`.

---

## üéì –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ú—É–ª—å—Ç–∏-–ø—Ä–æ–µ–∫—Ç –∞–Ω–∞–ª–∏–∑

–ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–∏—Å—Ç–µ–º–∞:
1. –û–±—ä–µ–¥–∏–Ω—è–µ—Ç diff'—ã —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
2. –ü–æ–Ω–∏–º–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
3. –ù–∞—Ö–æ–¥–∏—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```
backend/src/Api.java ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω endpoint
frontend/src/Dashboard.js ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç endpoint
‚Üí –°–∏—Å—Ç–µ–º–∞ –ø–æ–π–º–µ—Ç —Å–≤—è–∑—å –∏ –Ω–µ –≤—ã–¥–∞—Å—Ç –ª–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ
```

### –£–º–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è

–ï—Å–ª–∏ –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ 5 —Ñ–∞–π–ª–∞—Ö:
```markdown
**1. NPE –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ null –∑–Ω–∞—á–µ–Ω–∏–π**
- –ì–¥–µ: File1.java:45, File2.java:120, File3.java:88
```

–í–º–µ—Å—Ç–æ 5 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π.

### –ò–∑–±–µ–∂–∞–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏:
```markdown
QueryParser.java –¥–æ–±–∞–≤–∏–ª –º–µ—Ç–æ–¥ parsePercentile()
‚Üí PercentileCommand.java –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç –º–µ—Ç–æ–¥
‚Üí ‚úì –û–±–∞ –≤ —ç—Ç–æ–º MR ‚Äî –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞
```